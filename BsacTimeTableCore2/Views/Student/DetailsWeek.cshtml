@model List<StudentRecordViewModel>;
<environment include="Development">
    <link href="~/lib/bootstrap-datepicker/dist/css/bootstrap-datepicker3.css" rel="stylesheet" />
</environment>
<environment exclude="Development">
    <link href="~/lib/bootstrap-datepicker/dist/css/bootstrap-datepicker3.min.css" rel="stylesheet" />
</environment>
<form asp-action="DetailsWeek" method="get">
    <input hidden="hidden" name="idgroup" value=@Context.Request.Query["idgroup"]>
    <input hidden="hidden" name="subgroup" value=@Context.Request.Query["subgroup"]>
    <table align="center">
        <tr>
            <td style="padding-top:5px">Выберите неделю:</td>
            <td style="padding-top: 3px">
                <div style="max-width: 200px; padding-left:10px; " id="date" class="input-group date" data-provide="datepicker">
                    <input name="date" type="text" class="form-control">

                    <div class="input-group-addon">
                        <span class="glyphicon glyphicon-th"></span>
                    </div>

                </div>
            </td>
            <td style="padding-top: 3px; padding-left: 10px">
                <input type="submit" value="Показать" class="btn btn-default" />
            </td>
        </tr>
    </table>
</form>
<div>@ViewData["groupName"], @ViewData["subgroup"]-я подгруппа</div>
@{
    var dayOfWeek = 0;
    var lessonsForFourWeeks = new List<StudentRecordViewModel>();
}
<table class="table table-bordered">
    <thead>
        <tr>
            <th>Время</th>
            <th colspan="2">1я неделя</th>
            <th colspan="2">2я неделя</th>
            <th colspan="2">3я неделя</th>
            <th colspan="2">4я неделя</th>
        </tr>
    </thead>
    @for (var i = 0; i < Model.Count; i++)
    {

        @for (var j = 0; j < lessonsForFourWeeks.Count; j++)
        {
            if (lessonsForFourWeeks[j].SubjOrdinalNumber != Model[i].SubjOrdinalNumber || lessonsForFourWeeks[j].WeekDay != Model[i].WeekDay)
            {
                @Html.Partial("_FourLessons", lessonsForFourWeeks)
                lessonsForFourWeeks.Clear();
            }
        }
        lessonsForFourWeeks.Add(Model[i]);

        if (Model[i].WeekDay != dayOfWeek)
        {
            dayOfWeek = Model[i].WeekDay;
            @Html.Partial("_DayName", dayOfWeek)
        }

        if (i == Model.Count - 1)
        {
            @Html.Partial("_FourLessons", lessonsForFourWeeks)
        }


    }
</table>

@section Scripts{
    <environment include="Development">
        <script src="~/lib/bootstrap-datepicker/dist/js/bootstrap-datepicker.js"></script>
        <script src="~/lib/bootstrap-datepicker/dist/locales/bootstrap-datepicker.ru.min.js"></script>
    </environment>
    <environment exclude="Development">
        <script src="~/lib/bootstrap-datepicker/dist/js/bootstrap-datepicker.min.js"></script>
        <script src="~/lib/bootstrap-datepicker/dist/locales/bootstrap-datepicker.ru.min.js"></script>
    </environment>

    <script>
        $(document).ready(function () {
            $('#date').datepicker({
                format: 'dd/mm/yyyy',
                autoclose: true,
                language: 'ru'
            });
            $('#date').datepicker("setDate", new Date());
        })
    </script>
}